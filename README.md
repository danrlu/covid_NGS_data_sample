# Key file types in genomic epidemiology workflow with Illumina sequencing 

| data analysis | step 1 | step 2 | step 3 | step 4 | 
|---|-----|------|-------|--|
| file content | raw sequencing reads | reads mapped to reference genome | consensus genome | tree |
| file type | fastq file | bam file | fasta file | json file |

<br>

## Read file: `sample.fastq` or `sample.fq`

- The file generated by the sequencer is usually in FASTQ format. 
- Below is 1 read in the FASTQ file. 
```
@A00111:640:HVVF3DRXX:1:2101:30038:1063 1:N:0:CTCTGATTGCCT+TTGGTCTGCCGA
CTATCATTAACTGAATCCATAGGTTAATGAGGCGAACCGGGGGAACTGAAACATCTAAGTACCCCGAGGAAAAGAAATCAACCGAGATTCCCCCAGTAGCGGCGA
+
FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:FFFFFFFFFFFFFFFFFFFFF:FFF:FFFFFFFFFFFFFFFFFF:FFFFFFFFFFFFFFFFF:FFFFFFFF
```
-  
   + Row 1: read name starting with @ and followed by arbituary info based on sequencer and users.
   + Row 2: actual nucleotide sequence of the read
   + Row 3: usually a + sign
   + Row 4: quality (aka confidence) of each base in ASCII. It has to be the same length as row 2.

So each read is represented by 4 rows. If one FASTQ file contains 1000 reads, it will have 4 x 1000 = 4000 rows.

- If the sequencing is done in single-end mode, there will generate 1 FASTQ file for each sample; if it is done in paired-end mode, it will generate 2 FASTQ files for each sample (one for each read in the read pair), usually named as `sample_R1.fastq` and `sample_R2.fastq`.

- A real example from SRA (the NIH repository for sequencing read data): 

https://sra-pub-sars-cov2.s3.amazonaws.com/sra-src/SRR13690103/RR065e_01847_W-R175-A1_B01_covid_1.fq.gz.1

https://sra-pub-sars-cov2.s3.amazonaws.com/sra-src/SRR13690103/RR065e_01847_W-R175-A1_B01_covid_2.fq.gz.1  

- Further reading: https://support.illumina.com/bulletins/2016/04/fastq-files-explained.html

<br>

## Mapped read file: `sample.bam`

- To characterize an individual genome, aka to identify the mutations, we need to "compare" the sequencing reads originated from this genome to the reference genome.

- Such "comparison" results in a Bam file that contains comprehensive information of how each sequencing read match or differ from the reference genome. 

- Bam files are binary to reduce file size, so they require special tools to open and read. 

- This is an essential intermediate step in the workflow but bam files are usually not directly used in genomic epidemiology investigations.

<br>

## Consensus genome: `sample.fasta` or `sample.fa`

- With a reference genome and the information in a bam file , aka a reference genome and how the sample genome differs from it, one can re-constitute the full sample genome that was sequenced. 

- The resulting genomic sequence (the 'consensus genome') is stored in FASTA files.

- A FASTA file can contain 1 or several genomes.

- Below is an example FASTA file with 2 genomes:

```
>sample1_name
NNNNNNNNNCTTGTAGATCTGTTCTCTAAACGAACTTTAAAATCTGTGTGGCTGTCACTC
GGCTGCATGCTTAGTGCACTCACGCAGTATAATTAATAAC

>sample2_name
NNNNNNNNNCTCTTGTAGATCTGTTCTCTAAACGAACTTTAAAATCTGTGTGGCTGTCAC
TCGGCTGCATGCTTAGTGCACTCACGCAGTATAATTAATA
```
-
  + Rows starting with `>` contain the name of the genomes proceeding.
  + Nucleotide positions can have [more than 1 nucleotide composition](https://genome.ucsc.edu/goldenPath/help/iupac.html.). For example the beginning of example genomes are filled with N, which means they can be any nucleotide, due to low confidence in what these bases should be. 

- FASTA is the file people submit to GISAID or NCBI GenBank.


### Phylogeny tree: `all_samples.json`

- With genomes of multiple samples, one can build a phylogeny tree based on the similarity and differences in their genomes. 

- There are many file types used to store phylogeny trees. Nextstrain use specilized JSON files. These JSON files contain both structure of the tree and many useful metadata. 

- Here is [what Nextstrain do with the FASTA](https://docs.nextstrain.org/projects/augur/en/stable/index.html). The Augur pipeline export JSON which is the import for Auspice. 

- A [very simple JSON](https://github.com/czbiohub/covidtracker/raw/master/auspice/covidtracker_pawnee-examples.json) that one can drag and drop to https://auspice.us/

- [Example Nextstrain JSON](https://github.com/nextstrain/augur/blob/master/augur/data/schema-export-v2.json).

